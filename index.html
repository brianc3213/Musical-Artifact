<!DOCTYPE html>
<html lang="en">
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <link rel="stylesheet" type="text/css" href="table_css.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script language="JavaScript" src="https://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script language="JavaScript" src="https://cdn.datatables.net/1.10.4/js/jquery.dataTables.min.js" type="text/javascript"></script>
    <script language="JavaScript" src="https://cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <link rel="stylesheet" type="text/css" href="http://cdn.datatables.net/plug-ins/3cfcc339e89/integration/bootstrap/3/dataTables.bootstrap.css">
    <script>
        $(document).ready(function(){        
            console.log('make table');

            var topChartsPath = "https://veevveq2j8.execute-api.us-east-1.amazonaws.com/default/gtmsongs/topCharts"
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                    if(this.responseText == 'failed') {
                        alert("Login failed")
                        document.getElementById("Login").innerHTML = "Login";
                    } else {
                        console.log(this.responseText)
                        var data = JSON.parse(this.responseText)

                        var rows = document.getElementById('rows')
                        rows.innerHTML = ''

                        //data.foreach(row);
                        for (var i = 0; i < data.Count; i++) {
                            var newRow = document.createElement('tr')
                            var trackNumber = document.createElement('td')
                            trackNumber.innerHTML = i + 1
                            var title = document.createElement('td')
                            title.innerHTML = data.Songs[i].title
                            var artist = document.createElement('td')
                            artist.innerHTML = data.Songs[i].artist
                            var votes = document.createElement('td')
                            votes.innerHTML = data.Songs[i].votes
                            var emotions = document.createElement('td')
                            emotions.innerHTML = data.Songs[i].emotion

                            var edit = document.createElement('td')
                            // var newP = document.createElement('p')
                            // newP.setAttribute('data-placement', "top") 
                            //newP.setAttribute('data-toggle', "tooltip")
                            //newP.setAttribute('title', "Edit")

                            var deletes = document.createElement('td')
                            // deletes.innerHTML = data[i][3]

                            newRow.appendChild(trackNumber)
                            newRow.appendChild(title)
                            newRow.appendChild(artist)
                            newRow.appendChild(votes)
                            newRow.appendChild(emotions)
                            newRow.appendChild(edit)
                            newRow.appendChild(deletes)

                            rows.append(newRow);
                        }


                    }
                } else if(this.readyState == 4 && this.status == 404) {
                    alert("failed")
                }
            };
            xhttp.open("GET", topChartsPath, true);
            xhttp.send()

            if(!checkCookie()) {
                window.location = "./login.html"
            } else {
                var token = getCookie("token")
                console.log(token)
                $("#user").html("<a>" + token + "</a>")
                $("#user").attr({
                    "href" : null,
                });
                $("#register").html(null)

            }
        });

        function getCookie(cname) {
            var name = cname + "=";
            var ca = document.cookie.split(';');
            for(var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        function checkCookie() {
            var token = getCookie("token");
            if (token !== "") {
                return true
            } else {
                return false
            }
        }
    </script>

    <script>
        $(document).ready(function() {
            $('#datatable').dataTable();
            $("[data-toggle=tooltip]").tooltip();
        });
    </script>


    <head>
        <title>Musical Artifact</title>
    </head>

    <body>

        <style>
            .pagination {
                display: inline-block;
            }
            .pagination a {
                color: black;
                float: left;
                padding: 8px 16px;
                text-decoration: none;
                transition: background-color .3s;
                border: 1px solid #ddd;
            }
            .pagination a.active {
                background-color: #4CAF50;
                color: white;
                border: 1px solid #4CAF50;
            }
            .pagination a:hover:not(.active) {background-color: #ddd;}
        </style>
        
        <div class="container">

            <div>
                
            </dir>

            <div class="row">
                <h2 class="text-center">Top 100 Music</h2>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <table id="datatable" class="table table-striped table-bordered" cellspacing="0" width="100%">
                        <thead>
                            <tr>
                                <th>Rank</th>
                                <th>Songs</th>
                                <th>Artists</th>
                                <th>Votes</th>
                                <th>Emotions</th>
                                <th></th>
                            </tr>
                        </thead>

                        <tbody id="rows">

                        </tbody>

                    </table>
                </div>
                
                <div class="pagination">
                  <a href="#">&laquo;</a>
                  <a href="#">1</a>
                  <a href="#" class="active">2</a>
                  <a href="#">3</a>
                  <a href="#">4</a>
                  <a href="#">5</a>
                  <a href="#">6</a>
                  <a href="#">&raquo;</a>
                </div>
            </div>

        </div>

    	<div class="topnav">
    		<li><a href="login.html" id="user">Login</a>
    		<li><a href="register_account.html" id="register">Register</a>
            <li><a href="logout.html" id="logout">Logout</a>
    	</div>

    </body>

</html>
<li>
